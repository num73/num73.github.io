
**原文链接**：[Balanced Ternary - Algorithms for Competitive Programming (cp-algorithms.com)](https://cp-algorithms.com/algebra/balanced-ternary.html)
# 平衡三进制（Balanced Ternary）


## 介绍

![img](setun-1714885665366-2.jpg)

这是一个不太标准的**数字符号系统(numeral system)**。它的特点是每一位数字可以是`-1`, `0`和`1`。它是一个基于三进制的数字符号系统。因为使用`-1`来作为一个数字不太方便，我们接下来会使用字母`Z`来代替`-1`。图片里展示的是一台使用这种系统的计算机。

下面是一些使用这种平衡三进制来表示的数字：

```
    0    0
    1    1
    2    1Z
    3    10
    4    11
    5    1ZZ
    6    1Z0
    7    1Z1
    8    10Z
    9    100
```

这种符号系统允许你在书写符号的时候不使用前置的负号：在将正数转换成负数时，你需要将每一位数字转置（`1`变成`Z`，`Z`变成`1`）。

```
    -1   Z
    -2   Z1
    -3   Z0
    -4   ZZ
    -5   Z11
```

注意到，负数都是`Z`开头，正数都是`1`开头。

## 转换算法

通过将一个给定的数转换成普通的三进制形式，我们很容易将它表示成平衡三进制的形式。当一个数以三进制的形式表示时，它的每一位都是`0`,  `1`, `2`中的一个数。要将它转换成平衡三进制，我们从低位开始，如果遇到了`0`或`1`，那么这一位保持不变，如果遇到数字`2`，那么将`1`变成`Z`，并且下一位加`1`。如果加`1`后变成了数字`3`，`3`应该变成`0`，并且下一位要加`1`。

**例1**：将`64`转换成平衡三进制。首先我们先将`64`写成普通的三进制数形式：
$$
64_{10} = 02101_{3}
$$
我们从最右边一位开始处理：

* `1`，`0`，`1`被跳过，保持不变。
* `2`被转换成`Z`并且左边以为加`1`，我们得到了`1Z101`。

最终的结果是`1Z101`。
我们通过把每一位的权重加起来把它转换成普通的10进制数字：
$$
1Z101 = 81 \cdot 1 + 27 \cdot (-1) + 9 \cdot 1 + 3 \cdot 0 + 1 \cdot 1 = 64_{10}
$$
**例2**：将`237`平衡三进制。首先我们先将`237`写成普通的三进制数形式：
$$
237_{10} = 22210{3}
$$
我们从最右边一位开始处理：
* `0`，`1`被跳过，保持不变。

* `2`被转换成`Z`，左边一位加`1`，我们得到了`23Z10`。

* `3`被转换成`0`，左边一位加`1`，我们得到了`30Z10`。

* `3`被转换成`0`，左边以为加`1`，我们得到了`100Z10`。

最终的结果是`100Z10`。
我们将它转换成普通的10进制数字：
$$
10Z10 = 243 \cdot 1 + 81 \cdot 0 + 27 \cdot 0 + 9 \cdot (-1) + 3 \cdot 1 + 1 \cdot 0 = 273_{10}
$$



